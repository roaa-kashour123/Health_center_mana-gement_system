@startuml
skinparam defaultFontName Tajawal

start
:طلب \`staff.php\`;
:عرض \`staff.php\`;
:جلب وعرض قائمة الموظفين;

fork
  partition "إضافة موظف جديد" {
    :النقر على "إضافة موظف جديد";
    :عرض نموذج الإضافة (UI);
    :إدخال البيانات (الاسم، البريد، المسمى الوظيفي) والضغط على "إضافة الموظف";

    :استدعاء دالة \`addStaff(data)\`;
    :التحقق من وجود البريد الإلكتروني في قاعدة البيانات;
    
    if (البريد غير مستخدم والبيانات صالحة؟) then (نعم)
      :إدراج سجل جديد في جدول \`staff\` (\`status\` = 'active');
      :تأكيد الإدراج;
      :عرض رسالة نجاح وتحديث القائمة;
    else (لا)
      :خطأ في البيانات أو تكرار البريد;
      :عرض رسالة خطأ;
    endif
  }
fork again
  partition "تعديل حالة موظف" {
    :النقر على "تعليق" أو "تفعيل" للموظف (ID=X);
    :استدعاء دالة \`changeStatus(X, action)\`;
    :تحديث حقل \`status\` للموظف في قاعدة البيانات (\`UPDATE staff SET status = action WHERE id = X\`);
    
    if (نجاح التحديث؟) then (نعم)
      :تأكيد التحديث;
      :إعادة توجيه/تحديث الصفحة;
      :عرض القائمة المحدثة;
    else (لا)
      :فشل التحديث;
      :عرض رسالة خطأ;
    endif
  }
end fork

stop
@enduml